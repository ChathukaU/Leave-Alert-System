================================================================================
           ğŸ“– LEAVE ALERT SYSTEM - SETUP & MAINTENANCE GUIDE
================================================================================


TABLE OF CONTENTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. What This System Does
2. Initial Setup (One-Time)
3. Managing Teams & Employees
4. Manual Testing
5. Email Types
6. How It Works
7. Troubleshooting
8. View Execution History
9. Security
10. Quick Reference
11. Tips & Best Practices


================================================================================
1. ğŸ¯ WHAT THIS SYSTEM DOES
================================================================================

âœ… Automatically checks OrangeHRM for employees on leave
âœ… Sends daily reminder emails about who's on leave TODAY
âœ… Sends advance notification emails about who's going on leave TOMORROW
âœ… Only sends emails to team members (people on leave don't get emails)
âœ… No duplicate emails even if you're in multiple teams


================================================================================
2. ğŸš€ INITIAL SETUP (ONE-TIME)
================================================================================

STEP 1: CREATE THE GOOGLE APPS SCRIPT PROJECT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Go to https://script.google.com
2. Click "New Project"
3. Rename it to "Leave Alert System"


STEP 2: ADD THE CODE FILES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
You need 3 files:

File 1: Code.js
  1. Delete the default code
  2. Paste your Code.js content
  3. Save (Ctrl+S or Cmd+S)

File 2: Config.js
  1. Click + button â†’ Script
  2. Name it "Config"
  3. Paste your Config.js content
  4. Save

File 3: EmailTemplate.html
  1. Click + button â†’ HTML
  2. Name it "EmailTemplate"
  3. Paste your email template HTML
  4. Save


STEP 3: ADD YOUR ORANGEHRM LOGIN CREDENTIALS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Click "Project Settings" âš™ï¸ (gear icon on left sidebar)
2. Scroll down to "Script Properties"
3. Click "Add script property"
4. Add these two properties:

   Property        | Value
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€|â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   HRM_USERNAME    | Your OrangeHRM username
   HRM_PASSWORD    | Your OrangeHRM password

âš ï¸  IMPORTANT: These credentials are encrypted and secure.


STEP 4: TEST THE SYSTEM
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Before automating, test manually:

1. In the Apps Script editor, select "testSystem" from function dropdown
2. Click "Run"
3. First time: Click "Review permissions" â†’ Choose account â†’ Allow
4. Check the "Execution log" at bottom for results

Expected output:
  âœ“ HRM_USERNAME: Set
  âœ“ HRM_PASSWORD: Set
  âœ“ Authentication successful
  âœ“ ALL TESTS PASSED


STEP 5: SET UP AUTOMATED DAILY TRIGGERS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
For Daily Reminder (Today's Leaves):
  1. Click "Triggers" â° (clock icon on left sidebar)
  2. Click "Add Trigger"
  3. Configure:
     - Function: sendDailyLeaveReminder
     - Event source: Time-driven
     - Type: Day timer
     - Time: 8:00 AM to 9:00 AM (or your preferred time)
  4. Click "Save"

For Daily Notification (Tomorrow's Leaves):
  1. Click "Add Trigger" again
  2. Configure:
     - Function: sendDailyLeaveNotification
     - Event source: Time-driven
     - Type: Day timer
     - Time: 10:00 AM to 11:00 AM (or your preferred time)
  3. Click "Save"

âœ… DONE! The system will now run automatically every day.


================================================================================
3. ğŸ‘¥ MANAGING TEAMS & EMPLOYEES
================================================================================

Update Config.js File
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Open Config.js in the Apps Script editor to manage your teams.


ADD A NEW EMPLOYEE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Find the EMPLOYEES section and add a new line:

  const EMPLOYEES = {
    '0020': { name: 'Chathuka Upamith', email: 'chathuka@longwapps.com' },
    '0025': { name: 'New Employee Name', email: 'new@longwapps.com' }, // Add
  };

Rules:
  â€¢ Employee ID must match OrangeHRM (e.g., '0001', '0020')
  â€¢ Intern IDs start with 'I' (e.g., 'I001', 'I002')
  â€¢ Both name and email are required


ADD A NEW TEAM
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Find the TEAMS section and add:

  const TEAMS = [
    {
      teamName: 'Dev Team',
      members: ['0005', '0007', '0020']
    },
    {
      teamName: 'New Team Name',              // Add this
      members: ['0005', '0020', 'I001']       // team block
    }
  ];


ADD SOMEONE TO AN EXISTING TEAM
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Just add their ID to the members array:

  {
    teamName: 'Design Team',
    members: ['0020', '0005', 'I002', '0025']  // Added 0025
  }

Note: People can be in multiple teams - they'll still only get ONE email.


ADD A MANUAL LEAVE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
For employees not in OrangeHRM (interns, contractors), find the 
MANUAL_LEAVES section and add:

  const MANUAL_LEAVES = [
    // Full day leave (type is optional - defaults to full)
    { 
      employeeId: 'I001', 
      fromDate: '2025-07-26', 
      toDate: '2025-07-26'
    },
    
    // Multiple days
    { 
      employeeId: '0005', 
      fromDate: '2025-07-26', 
      toDate: '2025-07-29'
    },
    
    // Half day morning
    { 
      employeeId: 'I002', 
      fromDate: '2025-07-26', 
      toDate: '2025-07-26',
      type: 'morning'
    },
    
    // Half day afternoon
    { 
      employeeId: '0020', 
      fromDate: '2025-07-26', 
      toDate: '2025-07-26',
      type: 'afternoon'
    },
    
    // Specific time
    { 
      employeeId: 'I003', 
      fromDate: '2025-07-26', 
      toDate: '2025-07-26',
      type: 'time',
      startTime: '13:00',
      endTime: '17:00'
    }
  ];

Rules:
  â€¢ Date format: 'YYYY-MM-DD' (e.g., '2025-07-26')
  â€¢ Employee ID must exist in EMPLOYEES
  â€¢ Full day: No type needed (it's the default)
  â€¢ Half day/time: Only for single day (fromDate = toDate)
  â€¢ Time format: 24-hour (e.g., '13:00', '16:30')

Note: Manual leaves are automatically included in daily emails alongside 
OrangeHRM data.


================================================================================
4. ğŸ§ª MANUAL TESTING
================================================================================

TEST WITH TODAY'S DATE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Select function: sendDailyLeaveReminder
2. Click "Run"
3. Check execution log


TEST WITH A SPECIFIC PAST DATE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Open Config.js
2. Change MANUAL_REMINDER_DATE:
   
   const MANUAL_REMINDER_DATE = '2025-07-26';  // Change this date
   
3. Save
4. Select function: sendManualLeaveReminder
5. Click "Run"


TEST TOMORROW'S NOTIFICATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Open Config.js
2. Change MANUAL_NOTIFICATION_DATE:
   
   const MANUAL_NOTIFICATION_DATE = '2025-07-26';
   
3. Save
4. Select function: sendManualLeaveNotification
5. Click "Run"


================================================================================
5. ğŸ“§ EMAIL TYPES
================================================================================

1. DAILY REMINDER (Today's Leaves)
   â€¢ Sent: Every morning
   â€¢ Subject: "Reminder: Team Members on Leave Today â€“ [Date]"
   â€¢ Shows: Who is on leave TODAY
   â€¢ Format: Simple list with duration (Full Day, Half Day, etc.)

2. ADVANCE NOTIFICATION (Tomorrow's Leaves)
   â€¢ Sent: Every afternoon
   â€¢ Subject: "Notification: Upcoming Team Members on Leave"
   â€¢ Shows: Who is going on leave TOMORROW
   â€¢ Format: Table with leave type and full duration


================================================================================
6. ğŸ” HOW IT WORKS
================================================================================

WHO GETS EMAILS?
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… You WILL receive an email if:
   â€¢ You are in the same team as someone on leave
   â€¢ You are NOT on leave yourself

âŒ You WILL NOT receive an email if:
   â€¢ You are on leave (you already know!)
   â€¢ You are not in any team with the person on leave
   â€¢ Your email is not configured in Config.js


INTERNS LEAVE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Interns are typically not in OrangeHRM. Add their leave information using 
MANUAL_LEAVES, and they will be included in team notifications just like 
regular employees.


================================================================================
7. ğŸ› TROUBLESHOOTING
================================================================================

NO EMAILS SENT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Check these:
  1. Run testSystem - Are credentials working?
  2. Check Execution log for errors
  3. Verify trigger is active in Triggers page
  4. Confirm email addresses are correct in Config.js


SOMEONE DIDN'T GET EMAIL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Possible reasons:
  1. They are on leave (intentional - they shouldn't receive it)
  2. Their email is wrong in Config.js
  3. They are not in the same team as the person on leave
  4. Their ID is not in the EMPLOYEES list


WRONG NAMES IN EMAIL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Update the name in Config.js:

  '0020': { name: 'Correct Name Here', email: 'email@company.com' }


AUTHENTICATION FAILED
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. Check Script Properties for correct username/password
  2. Try logging into OrangeHRM manually with same credentials
  3. Password might have changed - update Script Properties


================================================================================
8. ğŸ“Š VIEW EXECUTION HISTORY
================================================================================

1. Click "Executions" ğŸ“œ (in left sidebar)
2. See all past runs with timestamps
3. Click any execution to see detailed logs

What to look for:
  âœ… "Authentication successful"
  âœ… "Reminder emails sent to team members"
  âŒ Any red errors


================================================================================
9. ğŸ”’ SECURITY
================================================================================

â€¢ Your OrangeHRM password is encrypted by Google
â€¢ Only you (the Google account owner) can access the script
â€¢ No sensitive data is stored in the code files
â€¢ Session cookies are temporary and cleared after each run


================================================================================
10. âœï¸ QUICK REFERENCE
================================================================================

COMMON TASKS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Task                    | Where to Go
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€|â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Add new employee        | Edit Config.js â†’ EMPLOYEES
Add new team            | Edit Config.js â†’ TEAMS
Add manual leave        | Edit Config.js â†’ MANUAL_LEAVES
Update email            | Edit Config.js â†’ EMPLOYEES
Change trigger time     | Triggers page â†’ Edit trigger
Test system             | Run testSystem function
View logs               | Click Executions in sidebar
Check credentials       | Project Settings â†’ Script Properties


AVAILABLE FUNCTIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Function                      | What It Does
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€|â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
testSystem                    | Validates setup and credentials
sendDailyLeaveReminder        | Sends today's leave reminder
sendDailyLeaveNotification    | Sends tomorrow's leave notification
sendManualLeaveReminder       | Test with specific date (reminder)
sendManualLeaveNotification   | Test with specific date (notification)


================================================================================
11. ğŸ’¡ TIPS & BEST PRACTICES
================================================================================

1. Always test after making changes - Run testSystem to verify

2. Keep Config.js updated - Remove people who leave the company

3. Use meaningful intern IDs - e.g., 'I001' for first intern

4. Check execution log regularly - Catch issues early

5. Update credentials if password changes - In Script Properties

6. Clean up old manual leaves - Remove past dates periodically

7. For full day leaves - No need to add type field (it defaults to full)


================================================================================
ğŸ“ NEED HELP?
================================================================================

1. Check the Execution log for error messages
2. Run testSystem to diagnose issues
3. Verify Config.js has correct data
4. Contact your IT team or system administrator


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Created by: Chathuka Upamith
ğŸ“§ Email: upamithc@gmail.com
ğŸ—“ï¸ Last Updated: December 2025
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

================================================================================